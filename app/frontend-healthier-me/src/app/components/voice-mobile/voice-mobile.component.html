<div class="tw-relative tw-bg-emerald-600 tw-top-10 tw-h-[calc(100dvh-2.5rem)] tw-overflow-auto no-scrollbar">
  <app-voice-sources [sources]="message!.sources"></app-voice-sources>
  <div class="tw-mt-[-80px]">
    <app-voice-message [message]="message" [isLoading]="isLoading"></app-voice-message>
  </div>
  <app-voice-annotation></app-voice-annotation>
  <app-voice-microphone [state]="micState" (click)="handleMicButtonClick()"></app-voice-microphone>
  <!-- Call mic click handler -->
  <div class="tw-text-center tw-text-xs tw-text-white tw-mt-[38px]">
    <p>Inspiring Tomorrow's Health</p>
    <p>Synapxe 2024</p>
  </div>
</div>

<div class="tw-absolute tw-bottom-6 tw-right-6">
  <p-button icon="pi pi-comment" (onClick)="toggleChatMode()" class="custom-border" />
</div>

<div class="tw-absolute tw-bottom-6 tw-right-6">
  <!-- <button (click)="preferenceOverlayPanel.toggle($event)" class="tw-text-white tw-pt-3"> -->
  <!-- <lucide-icon name="settings" class="tw-text-white"></lucide-icon> -->
  <!-- </button> -->
  <p-button icon="pi pi-comment" (onClick)="toggleChatMode()" class="custom-border" />
</div>

<p-overlayPanel #preferenceOverlayPanel>
  <div class="tw-grid tw-grid-cols-6 tw-justify-items-end">
    <label class="tw-w-full tw-col-span-5" id="interrupt">Interrupt with my voice</label>
    <p-inputSwitch (onChange)="prefVoiceInterrupt($event)" [(ngModel)]="voiceInterrupt" ariaLabelledBy="interrupt"></p-inputSwitch>
    <label class="tw-w-full tw-col-span-5" id="detect-start">Detect voice start</label>
    <p-inputSwitch (onChange)="prefVoiceStart($event)" [(ngModel)]="voiceDetectStart" ariaLabelledBy="detect-start"></p-inputSwitch>
    <label class="tw-w-full tw-col-span-5" id="detect-end">Detect voice end</label>
    <p-inputSwitch (onChange)="prefVoiceEnd($event)" [(ngModel)]="voiceDetectEnd" ariaLabelledBy="detect-end"></p-inputSwitch>
  </div>
</p-overlayPanel>

<p-dialog class="responsive-modal" [(visible)]="showTimeoutModal" [modal]="true" [closable]="true" [draggable]="false" header="Timeout">
  <p class="tw-text-center">Request Timed Out. Please try again later.</p>
</p-dialog>
